<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="ResIQ">
    <meta name="theme-color" content="#0ea5e9">
    <meta name="description" content="ResIQ - Modern Property Management System. Manage reservations, guests, payments, invoicing, and operations.">
    <title>ResIQ - Property Management System</title>
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="/assets/logo-192.png">

    <!-- External Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <style>
        /* Critical inline styles */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; overflow-x: hidden; }
        .loading-screen {
            position: fixed; inset: 0; display: flex; align-items: center; justify-content: center;
            background: linear-gradient(135deg, #0ea5e9 0%, #14b8a6 100%); z-index: 99999;
        }
        .loading-content { text-align: center; color: white; }
        .loading-spinner {
            width: 50px; height: 50px; border: 4px solid rgba(255,255,255,0.3);
            border-top-color: white; border-radius: 50%; animation: spin 1s linear infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        .hidden { display: none !important; }
        .view-container { display: none; }
        .view-container.active { display: block; }
    </style>
</head>
<body>

<!-- ========== LOADING SCREEN ========== -->
<div id="loadingScreen" class="loading-screen">
    <div class="loading-content">
        <img src="assets/logo.png" alt="ResIQ" style="height: 80px; margin-bottom: 24px; filter: brightness(0) invert(1);">
        <div class="loading-spinner"></div>
        <p style="margin-top: 20px; font-size: 14px; opacity: 0.9;">Loading ResIQ...</p>
    </div>
</div>

<!-- ========== LOGIN SCREEN ========== -->
<div id="loginScreen" class="login-screen hidden">
    <div class="login-card-modern animate-slide-in">
        <div class="login-logo-modern">
            <img src="assets/logo.png" alt="ResIQ">
            <h1>ResIQ</h1>
            <p>Property Management System</p>
        </div>
        <form id="loginForm" onsubmit="handleLogin(event)">
            <div class="form-group-modern">
                <label for="loginEmail">Email</label>
                <input type="email" id="loginEmail" class="form-input-modern" placeholder="admin@hostizzy.com" autocomplete="email" required>
            </div>
            <div class="form-group-modern">
                <label for="loginPassword">Password</label>
                <input type="password" id="loginPassword" class="form-input-modern" placeholder="Enter your password" autocomplete="current-password" required>
            </div>
            <button type="submit" class="btn-modern btn-modern-primary" style="width: 100%; margin-top: 8px;">
                <span>Sign In</span>
                <span>‚Üí</span>
            </button>
        </form>
        <p style="text-align: center; margin-top: 24px; font-size: 12px; color: var(--text-tertiary);">Secured by Hostizzy</p>
    </div>
</div>

<!-- ========== MAIN APP ========== -->
<div id="mainApp" class="app-container-modern hidden">

    <!-- ========== SIDEBAR (Desktop/Tablet) ========== -->
    <aside class="sidebar-modern" id="sidebar">
        <div class="sidebar-modern-header">
            <div class="sidebar-modern-logo" onclick="showView('home')">
                <img src="assets/logo.png" alt="ResIQ">
                <div class="sidebar-modern-logo-text">
                    <h2>ResIQ</h2>
                    <p>Property Management</p>
                </div>
            </div>
        </div>

        <nav class="sidebar-modern-nav">
            <div class="sidebar-modern-section">
                <div class="sidebar-modern-section-title">Main</div>
                <a class="sidebar-modern-item active" data-view="home" onclick="navigateTo('home')">
                    <span class="sidebar-modern-item-icon">üè†</span>
                    <span>Home</span>
                </a>
                <a class="sidebar-modern-item" data-view="dashboard" onclick="navigateTo('dashboard')">
                    <span class="sidebar-modern-item-icon">üìä</span>
                    <span>Dashboard</span>
                </a>
                <a class="sidebar-modern-item" data-view="reservations" onclick="navigateTo('reservations')">
                    <span class="sidebar-modern-item-icon">üìÖ</span>
                    <span>Reservations</span>
                    <span class="sidebar-modern-item-badge" id="reservationsBadge" style="display: none;">0</span>
                </a>
                <a class="sidebar-modern-item" data-view="guests" onclick="navigateTo('guests')">
                    <span class="sidebar-modern-item-icon">üë•</span>
                    <span>Guests</span>
                </a>
            </div>

            <div class="sidebar-modern-section">
                <div class="sidebar-modern-section-title">Financial</div>
                <a class="sidebar-modern-item" data-view="payments" onclick="navigateTo('payments')">
                    <span class="sidebar-modern-item-icon">üí∞</span>
                    <span>Payments</span>
                </a>
                <a class="sidebar-modern-item" data-view="invoices" onclick="navigateTo('invoices')">
                    <span class="sidebar-modern-item-icon">üßæ</span>
                    <span>Invoices</span>
                </a>
            </div>

            <div class="sidebar-modern-section">
                <div class="sidebar-modern-section-title">Operations</div>
                <a class="sidebar-modern-item" data-view="documents" onclick="navigateTo('documents')">
                    <span class="sidebar-modern-item-icon">üìã</span>
                    <span>Documents</span>
                    <span class="sidebar-modern-item-badge" id="documentsBadge" style="display: none;">0</span>
                </a>
                <a class="sidebar-modern-item" data-view="communications" onclick="navigateTo('communications')">
                    <span class="sidebar-modern-item-icon">üì±</span>
                    <span>Communications</span>
                </a>
                <a class="sidebar-modern-item" data-view="properties" onclick="navigateTo('properties')">
                    <span class="sidebar-modern-item-icon">üèòÔ∏è</span>
                    <span>Properties</span>
                </a>
            </div>

            <div class="sidebar-modern-section">
                <div class="sidebar-modern-section-title">Settings</div>
                <a class="sidebar-modern-item" data-view="team" onclick="navigateTo('team')">
                    <span class="sidebar-modern-item-icon">üë®‚Äçüíº</span>
                    <span>Team</span>
                </a>
                <a class="sidebar-modern-item" data-view="settings" onclick="navigateTo('settings')">
                    <span class="sidebar-modern-item-icon">‚öôÔ∏è</span>
                    <span>Settings</span>
                </a>
            </div>
        </nav>

        <div class="sidebar-modern-footer">
            <div class="sidebar-modern-user" onclick="handleLogout()">
                <div class="sidebar-modern-user-avatar" id="userAvatar">U</div>
                <div class="sidebar-modern-user-info">
                    <h4 id="userName">User</h4>
                    <p id="userEmail">user@hostizzy.com</p>
                </div>
            </div>
        </div>
    </aside>

    <!-- ========== MAIN CONTENT ========== -->
    <main class="main-content-modern">

        <!-- ========== HOME VIEW (Icon Grid) ========== -->
        <div id="homeView" class="view-container active">
            <header class="main-header-modern">
                <div class="main-header-content">
                    <div class="main-header-title">
                        <h1 id="greetingTitle">Good Morning!</h1>
                        <p id="greetingSubtitle">Welcome back to ResIQ</p>
                    </div>
                    <div class="main-header-actions">
                        <div class="search-bar-modern">
                            <span class="search-bar-modern-icon">üîç</span>
                            <input type="text" placeholder="Search..." id="globalSearch">
                        </div>
                    </div>
                </div>
            </header>

            <div class="main-body-modern">
                <!-- Quick Stats Row -->
                <div class="home-stats-row">
                    <div class="home-stat-card" onclick="navigateTo('reservations')">
                        <div class="home-stat-icon">üìÖ</div>
                        <div class="home-stat-value" id="homeStatReservations">0</div>
                        <div class="home-stat-label">Active Reservations</div>
                    </div>
                    <div class="home-stat-card" onclick="navigateTo('payments')">
                        <div class="home-stat-icon">üí∞</div>
                        <div class="home-stat-value" id="homeStatRevenue">‚Çπ0</div>
                        <div class="home-stat-label">Monthly Revenue</div>
                    </div>
                    <div class="home-stat-card" onclick="navigateTo('guests')">
                        <div class="home-stat-icon">üë•</div>
                        <div class="home-stat-value" id="homeStatGuests">0</div>
                        <div class="home-stat-label">Total Guests</div>
                    </div>
                    <div class="home-stat-card" onclick="navigateTo('documents')">
                        <div class="home-stat-icon">üìã</div>
                        <div class="home-stat-value" id="homeStatPending">0</div>
                        <div class="home-stat-label">Pending KYC</div>
                    </div>
                </div>

                <!-- Icon Grid -->
                <div class="home-icon-grid">
                    <div class="home-icon-item" onclick="navigateTo('dashboard')">
                        <div class="home-icon-wrapper" style="background: linear-gradient(135deg, #0ea5e9 0%, #06b6d4 100%);">
                            <span class="home-icon">üìä</span>
                        </div>
                        <span class="home-icon-label">Dashboard</span>
                    </div>

                    <div class="home-icon-item" onclick="navigateTo('reservations')">
                        <div class="home-icon-wrapper" style="background: linear-gradient(135deg, #8b5cf6 0%, #a855f7 100%);">
                            <span class="home-icon">üìÖ</span>
                        </div>
                        <span class="home-icon-label">Reservations</span>
                    </div>

                    <div class="home-icon-item" onclick="navigateTo('guests')">
                        <div class="home-icon-wrapper" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);">
                            <span class="home-icon">üë•</span>
                        </div>
                        <span class="home-icon-label">Guests</span>
                    </div>

                    <div class="home-icon-item" onclick="navigateTo('payments')">
                        <div class="home-icon-wrapper" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);">
                            <span class="home-icon">üí∞</span>
                        </div>
                        <span class="home-icon-label">Payments</span>
                    </div>

                    <div class="home-icon-item" onclick="navigateTo('invoices')">
                        <div class="home-icon-wrapper" style="background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);">
                            <span class="home-icon">üßæ</span>
                        </div>
                        <span class="home-icon-label">Invoices</span>
                    </div>

                    <div class="home-icon-item" onclick="navigateTo('documents')">
                        <div class="home-icon-wrapper" style="background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);">
                            <span class="home-icon">üìã</span>
                        </div>
                        <span class="home-icon-label">Documents</span>
                    </div>

                    <div class="home-icon-item" onclick="navigateTo('communications')">
                        <div class="home-icon-wrapper" style="background: linear-gradient(135deg, #14b8a6 0%, #0d9488 100%);">
                            <span class="home-icon">üì±</span>
                        </div>
                        <span class="home-icon-label">Communications</span>
                    </div>

                    <div class="home-icon-item" onclick="navigateTo('properties')">
                        <div class="home-icon-wrapper" style="background: linear-gradient(135deg, #ec4899 0%, #db2777 100%);">
                            <span class="home-icon">üèòÔ∏è</span>
                        </div>
                        <span class="home-icon-label">Properties</span>
                    </div>

                    <div class="home-icon-item" onclick="navigateTo('team')">
                        <div class="home-icon-wrapper" style="background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);">
                            <span class="home-icon">üë®‚Äçüíº</span>
                        </div>
                        <span class="home-icon-label">Team</span>
                    </div>

                    <div class="home-icon-item" onclick="navigateTo('settings')">
                        <div class="home-icon-wrapper" style="background: linear-gradient(135deg, #64748b 0%, #475569 100%);">
                            <span class="home-icon">‚öôÔ∏è</span>
                        </div>
                        <span class="home-icon-label">Settings</span>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="card-modern" style="margin-top: var(--spacing-2xl);">
                    <div class="card-modern-header">
                        <h3>Recent Activity</h3>
                        <p>Latest updates from your properties</p>
                    </div>
                    <div class="card-modern-body">
                        <div id="recentActivity">
                            <div class="empty-state-modern">
                                <div class="empty-state-modern-icon">üìã</div>
                                <h3>No recent activity</h3>
                                <p>Activity will appear here as you use the app</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ========== DASHBOARD VIEW ========== -->
        <div id="dashboardView" class="view-container">
            <header class="main-header-modern">
                <div class="main-header-content">
                    <div class="main-header-title">
                        <button class="btn-back-modern" onclick="navigateTo('home')">‚Üê Back</button>
                        <div>
                            <h1>Dashboard</h1>
                            <p>Overview of your property management</p>
                        </div>
                    </div>
                    <div class="main-header-actions">
                        <button class="btn-modern btn-modern-primary" onclick="openNewReservationModal()">
                            <span>‚ûï</span>
                            <span>New Reservation</span>
                        </button>
                    </div>
                </div>
            </header>

            <div class="main-body-modern">
                <!-- Stats Grid -->
                <div class="stats-grid-modern" id="dashboardStats">
                    <div class="stat-card-modern">
                        <div class="stat-card-modern-header">
                            <span class="stat-card-modern-title">Total Reservations</span>
                            <div class="stat-card-modern-icon" style="background: var(--primary-subtle);">üìÖ</div>
                        </div>
                        <div class="stat-card-modern-value" id="statTotalReservations">0</div>
                        <div class="stat-card-modern-footer">
                            <span class="stat-card-modern-trend up">‚Üë 12%</span>
                            <span style="color: var(--text-tertiary);">vs last month</span>
                        </div>
                    </div>

                    <div class="stat-card-modern">
                        <div class="stat-card-modern-header">
                            <span class="stat-card-modern-title">Revenue</span>
                            <div class="stat-card-modern-icon" style="background: var(--success-subtle);">üí∞</div>
                        </div>
                        <div class="stat-card-modern-value" id="statTotalRevenue">‚Çπ0</div>
                        <div class="stat-card-modern-footer">
                            <span class="stat-card-modern-trend up">‚Üë 8%</span>
                            <span style="color: var(--text-tertiary);">vs last month</span>
                        </div>
                    </div>

                    <div class="stat-card-modern">
                        <div class="stat-card-modern-header">
                            <span class="stat-card-modern-title">Pending Payments</span>
                            <div class="stat-card-modern-icon" style="background: var(--warning-subtle);">‚ö†Ô∏è</div>
                        </div>
                        <div class="stat-card-modern-value" id="statPendingPayments">‚Çπ0</div>
                        <div class="stat-card-modern-footer">
                            <span class="stat-card-modern-trend down">‚Üì 5%</span>
                            <span style="color: var(--text-tertiary);">vs last month</span>
                        </div>
                    </div>

                    <div class="stat-card-modern">
                        <div class="stat-card-modern-header">
                            <span class="stat-card-modern-title">Occupancy Rate</span>
                            <div class="stat-card-modern-icon" style="background: var(--info-subtle);">üìà</div>
                        </div>
                        <div class="stat-card-modern-value" id="statOccupancy">0%</div>
                        <div class="stat-card-modern-footer">
                            <span class="stat-card-modern-trend up">‚Üë 3%</span>
                            <span style="color: var(--text-tertiary);">vs last month</span>
                        </div>
                    </div>
                </div>

                <!-- Charts Row -->
                <div style="display: grid; grid-template-columns: 2fr 1fr; gap: var(--spacing-lg); margin-bottom: var(--spacing-lg);">
                    <div class="card-modern">
                        <div class="card-modern-header">
                            <h3>Revenue Trend</h3>
                            <p>Last 6 months performance</p>
                        </div>
                        <div class="card-modern-body">
                            <canvas id="revenueChart" style="max-height: 300px;"></canvas>
                        </div>
                    </div>

                    <div class="card-modern">
                        <div class="card-modern-header">
                            <h3>Booking Sources</h3>
                            <p>Channel distribution</p>
                        </div>
                        <div class="card-modern-body">
                            <canvas id="sourcesChart" style="max-height: 300px;"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Recent Reservations -->
                <div class="card-modern">
                    <div class="card-modern-header" style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <h3>Recent Reservations</h3>
                            <p>Latest bookings and their status</p>
                        </div>
                        <button class="btn-modern btn-modern-ghost btn-modern-sm" onclick="navigateTo('reservations')">
                            View All ‚Üí
                        </button>
                    </div>
                    <div class="card-modern-body" style="padding: 0;">
                        <div class="table-modern-container" style="border: none; box-shadow: none;">
                            <table class="table-modern">
                                <thead>
                                    <tr>
                                        <th>Booking ID</th>
                                        <th>Guest</th>
                                        <th>Property</th>
                                        <th>Check-in</th>
                                        <th>Amount</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody id="recentReservationsTable">
                                    <tr>
                                        <td colspan="6">
                                            <div class="empty-state-modern">
                                                <div class="empty-state-modern-icon">üìÖ</div>
                                                <h3>No reservations yet</h3>
                                                <p>Create your first reservation to get started</p>
                                                <button class="btn-modern btn-modern-primary" onclick="openNewReservationModal()">
                                                    Create Reservation
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ========== RESERVATIONS VIEW ========== -->
        <div id="reservationsView" class="view-container">
            <header class="main-header-modern">
                <div class="main-header-content">
                    <div class="main-header-title">
                        <button class="btn-back-modern" onclick="navigateTo('home')">‚Üê Back</button>
                        <div>
                            <h1>Reservations</h1>
                            <p>Manage all your bookings</p>
                        </div>
                    </div>
                    <div class="main-header-actions">
                        <button class="btn-modern btn-modern-secondary btn-modern-sm">
                            <span>üì•</span>
                            <span>Export</span>
                        </button>
                        <button class="btn-modern btn-modern-primary" onclick="openNewReservationModal()">
                            <span>‚ûï</span>
                            <span>New Reservation</span>
                        </button>
                    </div>
                </div>
            </header>

            <div class="main-body-modern">
                <!-- Filters -->
                <div class="filters-bar-modern">
                    <span style="font-weight: 600; color: var(--text-secondary); font-size: var(--text-sm);">Filter:</span>
                    <div class="filter-chip-modern active" onclick="filterReservations('all', event)">All</div>
                    <div class="filter-chip-modern" onclick="filterReservations('confirmed', event)">Confirmed</div>
                    <div class="filter-chip-modern" onclick="filterReservations('checked-in', event)">Checked In</div>
                    <div class="filter-chip-modern" onclick="filterReservations('checked-out', event)">Checked Out</div>
                    <div class="filter-chip-modern" onclick="filterReservations('cancelled', event)">Cancelled</div>
                </div>

                <!-- Reservations Table -->
                <div class="table-modern-container">
                    <table class="table-modern">
                        <thead>
                            <tr>
                                <th>Booking ID</th>
                                <th>Guest Name</th>
                                <th>Property</th>
                                <th>Check-in</th>
                                <th>Check-out</th>
                                <th>Amount</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="reservationsTableBody">
                            <tr>
                                <td colspan="8">
                                    <div class="empty-state-modern">
                                        <div class="empty-state-modern-icon">üìÖ</div>
                                        <h3>No reservations</h3>
                                        <p>Create your first reservation to get started</p>
                                        <button class="btn-modern btn-modern-primary" onclick="openNewReservationModal()">
                                            Create Reservation
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Other views with back buttons... -->
        <div id="guestsView" class="view-container">
            <header class="main-header-modern">
                <div class="main-header-content">
                    <div class="main-header-title">
                        <button class="btn-back-modern" onclick="navigateTo('home')">‚Üê Back</button>
                        <div><h1>Guests</h1><p>Manage guest profiles</p></div>
                    </div>
                </div>
            </header>
            <div class="main-body-modern"><p>Guests view - Coming soon...</p></div>
        </div>

        <div id="paymentsView" class="view-container">
            <header class="main-header-modern">
                <div class="main-header-content">
                    <div class="main-header-title">
                        <button class="btn-back-modern" onclick="navigateTo('home')">‚Üê Back</button>
                        <div><h1>Payments</h1><p>Track payments and transactions</p></div>
                    </div>
                </div>
            </header>
            <div class="main-body-modern"><p>Payments view - Coming soon...</p></div>
        </div>

        <div id="invoicesView" class="view-container">
            <header class="main-header-modern">
                <div class="main-header-content">
                    <div class="main-header-title">
                        <button class="btn-back-modern" onclick="navigateTo('home')">‚Üê Back</button>
                        <div><h1>Invoices</h1><p>GST-compliant invoicing</p></div>
                    </div>
                </div>
            </header>
            <div class="main-body-modern"><p>Invoices view - Coming soon...</p></div>
        </div>

        <div id="documentsView" class="view-container">
            <header class="main-header-modern">
                <div class="main-header-content">
                    <div class="main-header-title">
                        <button class="btn-back-modern" onclick="navigateTo('home')">‚Üê Back</button>
                        <div><h1>Documents (KYC)</h1><p>Verify guest documents</p></div>
                    </div>
                </div>
            </header>
            <div class="main-body-modern"><p>Documents view - Coming soon...</p></div>
        </div>

        <div id="communicationsView" class="view-container">
            <header class="main-header-modern">
                <div class="main-header-content">
                    <div class="main-header-title">
                        <button class="btn-back-modern" onclick="navigateTo('home')">‚Üê Back</button>
                        <div><h1>Communications</h1><p>Unified messaging center</p></div>
                    </div>
                </div>
            </header>
            <div class="main-body-modern"><p>Communications view - Coming soon...</p></div>
        </div>

        <div id="propertiesView" class="view-container">
            <header class="main-header-modern">
                <div class="main-header-content">
                    <div class="main-header-title">
                        <button class="btn-back-modern" onclick="navigateTo('home')">‚Üê Back</button>
                        <div><h1>Properties</h1><p>Manage your properties</p></div>
                    </div>
                </div>
            </header>
            <div class="main-body-modern"><p>Properties view - Coming soon...</p></div>
        </div>

        <div id="teamView" class="view-container">
            <header class="main-header-modern">
                <div class="main-header-content">
                    <div class="main-header-title">
                        <button class="btn-back-modern" onclick="navigateTo('home')">‚Üê Back</button>
                        <div><h1>Team</h1><p>Manage team members</p></div>
                    </div>
                </div>
            </header>
            <div class="main-body-modern"><p>Team view - Coming soon...</p></div>
        </div>

        <div id="settingsView" class="view-container">
            <header class="main-header-modern">
                <div class="main-header-content">
                    <div class="main-header-title">
                        <button class="btn-back-modern" onclick="navigateTo('home')">‚Üê Back</button>
                        <div><h1>Settings</h1><p>Configure your account</p></div>
                    </div>
                </div>
            </header>
            <div class="main-body-modern"><p>Settings view - Coming soon...</p></div>
        </div>

    </main>

    <!-- ========== MOBILE BOTTOM NAV ========== -->
    <nav class="mobile-bottom-nav">
        <a class="mobile-nav-item active" onclick="navigateTo('home')">
            <span class="mobile-nav-icon">üè†</span>
            <span class="mobile-nav-label">Home</span>
        </a>
        <a class="mobile-nav-item" onclick="navigateTo('reservations')">
            <span class="mobile-nav-icon">üìÖ</span>
            <span class="mobile-nav-label">Bookings</span>
        </a>
        <a class="mobile-nav-item fab-item" onclick="openQuickActions()">
            <span class="mobile-nav-icon fab-icon">+</span>
        </a>
        <a class="mobile-nav-item" onclick="navigateTo('communications')">
            <span class="mobile-nav-icon">üì±</span>
            <span class="mobile-nav-label">Messages</span>
        </a>
        <a class="mobile-nav-item" onclick="navigateTo('settings')">
            <span class="mobile-nav-icon">‚öôÔ∏è</span>
            <span class="mobile-nav-label">More</span>
        </a>
    </nav>

</div>

<!-- Toast -->
<div id="toast" class="toast-modern"></div>

<!-- Load Modules -->
<script type="module" src="/src/main.js"></script>

<!-- Core App Logic -->
<script>
let currentView = 'home';

// Initialize app
document.addEventListener('DOMContentLoaded', () => {
    setTimeout(() => {
        document.getElementById('loadingScreen').classList.add('hidden');
        document.getElementById('loginScreen').classList.remove('hidden');
        updateGreeting();
    }, 1000);
});

// Update greeting based on time
function updateGreeting() {
    const hour = new Date().getHours();
    const greetingTitle = document.getElementById('greetingTitle');
    const greetingSubtitle = document.getElementById('greetingSubtitle');

    if (hour < 12) {
        greetingTitle.textContent = 'Good Morning!';
        greetingSubtitle.textContent = 'Start your day with ResIQ';
    } else if (hour < 18) {
        greetingTitle.textContent = 'Good Afternoon!';
        greetingSubtitle.textContent = 'Manage your properties efficiently';
    } else {
        greetingTitle.textContent = 'Good Evening!';
        greetingSubtitle.textContent = 'Review today\'s progress';
    }
}

// Login handler
function handleLogin(e) {
    e.preventDefault();
    document.getElementById('loginScreen').classList.add('hidden');
    document.getElementById('mainApp').classList.remove('hidden');

    const email = document.getElementById('loginEmail').value;
    document.getElementById('userEmail').textContent = email;
    document.getElementById('userName').textContent = email.split('@')[0];
    document.getElementById('userAvatar').textContent = email[0].toUpperCase();

    // Haptic feedback
    if ('vibrate' in navigator) navigator.vibrate(10);
}

// Logout handler
function handleLogout() {
    if (confirm('Are you sure you want to logout?')) {
        document.getElementById('mainApp').classList.add('hidden');
        document.getElementById('loginScreen').classList.remove('hidden');
        if ('vibrate' in navigator) navigator.vibrate([10, 20, 10]);
    }
}

// Navigate to view
function navigateTo(viewName) {
    // Hide all views
    document.querySelectorAll('.view-container').forEach(v => v.classList.remove('active'));

    // Show selected view
    const view = document.getElementById(viewName + 'View');
    if (view) {
        view.classList.add('active');
        currentView = viewName;

        // Update sidebar active state
        document.querySelectorAll('.sidebar-modern-item').forEach(item => {
            item.classList.remove('active');
            if (item.dataset.view === viewName) {
                item.classList.add('active');
            }
        });

        // Update mobile nav active state
        document.querySelectorAll('.mobile-nav-item:not(.fab-item)').forEach(item => {
            item.classList.remove('active');
        });
        if (event && event.currentTarget) {
            event.currentTarget.classList.add('active');
        }

        // Haptic feedback
        if ('vibrate' in navigator) navigator.vibrate(5);

        // Scroll to top
        window.scrollTo(0, 0);
    }
}

// Filter reservations
function filterReservations(status, event) {
    if (event) {
        document.querySelectorAll('.filter-chip-modern').forEach(chip => {
            chip.classList.remove('active');
        });
        event.target.classList.add('active');
    }
    console.log('Filter by:', status);
    if ('vibrate' in navigator) navigator.vibrate(5);
}

// Placeholder functions
function openNewReservationModal() {
    showToast('New Reservation feature coming soon!', 'info');
    if ('vibrate' in navigator) navigator.vibrate(10);
}

function openQuickActions() {
    showToast('Quick Actions menu coming soon!', 'info');
    if ('vibrate' in navigator) navigator.vibrate(10);
}

// Toast notification
function showToast(message, type = 'info') {
    const toast = document.getElementById('toast');
    toast.textContent = message;
    toast.className = 'toast-modern toast-' + type;
    toast.style.display = 'block';

    setTimeout(() => {
        toast.style.display = 'none';
    }, 3000);
}
</script>

</body>
</html>
